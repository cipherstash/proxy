# My Little Proxy


Experiments in Minimally Viable Proxying.

My Little Proxy connects directly to Postgres and demonstrates intercepting and rewriting `jsonb` parameters.

Supports both `binary` and `text` formats.


### But why!?

The entire codebase is about `1/5` of the size than the current pgcat `client.rs` file.


### Note
The rest of the owl needs to be drawn.


```
............................................*.......................................................
...........................................#+#......................................................
..........................................##+++..............=#.....................................
..........................................+#+###........:#+:*##.....................................
.........................................+==###+=-++++#++:+.+#......................................
........................................#+-:=#:.-=##+--++#:#*=......................................
.......................................#+:::-##::+**=-=+-*:*#.......................................
.......................................+-:.#=:.#.+*##-:#.#+#........................................
.....................................#=*:-#.:+###.+##-#=:.#+........................................
....................................-=#=.:#-+#.+**.-#*#*#.##=.......................................
....................................#-#-::*:..=-:#+#:#=-++##........................................
.....................................=*=:-#=.-+-:####:=+=###........................................
....................................=##-+:-####=:=*-.+*##*-==.......................................
...................................+##=##-+#=+*########++.-+#-......................................
..................................++#+*++-###*:+:--+==+.##==*+......................................
.................................:.###:=--=####-:::--.##..-=###.....................................
...................................-#..#:+#*.-=-=###:##...+####.....................................
..................................=+*=-###.::##----#+*--#.+##+#+....................................
..................................+##=.+=-=+-=#=..:=*##+..+#####....................................
...................................#......#+..:++:::::....:###*#....................................
...................................#=+.=-.-:..+::.:::.::-.-#####....................................
...................................#=++..=.....*+.=-:::.--.#+###....................................
...................................#=-+..:+....#..:*...-.--.####....................................
...................................==*=.+........::--......:+++#....................................
.....................................#==.-:=::......=::.=:..=-+#....................................
......................................#++..............++=:..###....................................
........................++:++++==::....-#:--:.--.--:...:.....#-.....................................
........................:::=+::+-=+++#####:...::............#+......................................
................................---+#++++#+--.............=+========:::::...:.......................
...............................:---====-:.#.#-:-:#=-.#-.#=##:::.::--*******##*******................
..............................:-*****:::-+.--=*+=#.-*.**##*##+=======######-=-:::...................
.........................====-.......-+-=+++*++=---******:-+--......................................
............................................##*::====--*#*.+:-*+==*#=####*+-====::..................
.............................................##::..:.--+.:##..............:=+*......................
..............................................#+#..++=:+.+*#........................................
...............................................#+=.=++.#+.#+........................................
................................................==**+*:+*##+........................................
..................................................+##*###*#.........................................
```


## Tests

Assumes a database called `my_little_proxy` and a `blah` table.


```sql
CREATE TABLE blah (
    id bigint GENERATED ALWAYS AS IDENTITY,
    t TEXT,
    j JSONB,
    vtha JSONB,
    PRIMARY KEY(id)
);
```

Run the proxy

```bash
cargo run
```


Run the test

```bash
cargo test -- --nocapture
```



